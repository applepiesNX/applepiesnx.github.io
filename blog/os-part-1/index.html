<!doctype html>
    <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <!-- FAVICON -->
      
      
      <link href='&#x2F;icons&#x2F;favicon-16x16.png' rel="icon" sizes="16x16" type="image/png" />
      
      
      <link href='&#x2F;icons&#x2F;favicon-32x32.png' rel="icon" sizes="32x32" type="image/png" />
      
      
      <link href='&#x2F;icons&#x2F;android-chrome-512x512.png' rel="android-chrome" sizes="512x512" />
      
      
      <link href='&#x2F;icons&#x2F;android-chrome-192x192.png' rel="android-chrome" sizes="192x192" />
      
      
      <link href='&#x2F;icons&#x2F;apple-touch-icon.png' rel="apple-touch-icon" sizes="180x180" />
      
      
      <link href='&#x2F;icons&#x2F;apple-touch-icon.png' rel="apple-touch-icon" sizes="180x180" />
      

      <link href="/css/main.css" rel="stylesheet">
      <link id="syntax_highlight" href="#" rel="stylesheet">

      <title>
        
        applepiesNX&#x27;s Blog
        
      </title>
  </head>
  <body class="dark:bg-gray-700 flex flex-col h-screen justify-between">
  <!---------------------------------------------------------->
  <!------------------------- NAVBAR ------------------------->
  <!---------------------------------------------------------->
  <nav id="navbar" class="bg-gray-200 dark:bg-gray-800">
    <div class="max-w-7xl mx-auto px-2 sm:px-6 lg:px-8">
      <div class="relative flex items-center justify-between h-16">
        <div class="flex items-center sm:hidden">
          <!-- Mobile menu button-->
          <button id="toggle-mobile-menu" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <!--
              Icon when menu is closed.
              Heroicon name: outline/menu
              Menu open: "hidden", Menu closed: "block"
            -->
            <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <!--
              Icon when menu is open.
              Heroicon name: outline/x
              Menu open: "block", Menu closed: "hidden"
            -->
            <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="flex-1 flex items-center">
          <div class="flex-shrink-0 flex items-center ml-2">
            <a href="/" class="text-xl text-gray-800 dark:text-white">applepiesNX&#x27;s Blog</a>
            <!-- <img class="block lg:hidden h-8 w-auto" src="https://tailwindui.com/img/logos/workflow-mark-indigo-500.svg" alt="Workflow">
            <img class="hidden lg:block h-8 w-auto" src="https://tailwindui.com/img/logos/workflow-logo-indigo-500-mark-white-text.svg" alt="Workflow"> -->
          </div>
          <div class="hidden sm:block sm:ml-6">
            <div class="nav-links flex space-x-4">
              <!-- Current: "bg-gray-900 text-white", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
              
                
                  
                    <a href="&#x2F;" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Home</a>
                  
                    <a href="&#x2F;categories" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Categories</a>
                  
                    <a href="&#x2F;tags" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Tags</a>
                  
                    <a href="&#x2F;blog" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Blog</a>
                  
                
              

              
              <!-- More ... Button (sidebar) -->
              <button id="toggle-sidebar">
                <svg class="w-7 h-7 text-gray-800 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
                </svg>
              </button>
              
            </div>
          </div>

          
          <!-- Search input in navbar -->
          <div class="flex ml-auto relative items-center sm:mr-4">
            <input id="search" class="rounded-xl border border-black dark:border-gray-200 h-9 text-black dark:text-gray-200 dark:bg-gray-700 w-24 sm:w-full" type="text">
            <svg class="w-6 h-6 absolute left-2 text-black dark:text-gray-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <span class="absolute right-2 hidden sm:block text-gray-400 text-sm leading-5 py-0.5 px-1.5 border border-gray-300 rounded-md">
              <kbd class="font-sans">
                <abbr title="Command" class="no-underline">âŒ˜</abbr>
              </kbd>
              <kbd class="font-sans">K</kbd>
            </span>
          </div>

          <!---------------------------- Search box modal ---------------------------->
          <!-- inspired by https://www.tailwindtoolbox.com/components/modal -->
          <div id="search-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex z-10">
            <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>

            <div class="modal-container text-gray-800 bg-gray-200 dark:bg-gray-800 dark:text-gray-400 w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg z-50 mt-40 sm:mt-32 h-36 border border-2 border-gray-800 dark:border-gray-400">

              <div class="modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50">
                <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                  <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                </svg>
                <span class="text-sm">(Esc)</span>
              </div>

              <!-- Modal Content-->
              <div class="py-4 text-left px-6 flex flex-col">
                <!-- Modal Title -->
                <div class="flex justify-between items-center pb-3">
                  <p class="text-2xl font-bold">Search</p>
                  <div class="modal-close cursor-pointer z-50">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                  </div>
                </div>

                <!-- Modal Body -->
                <input id="search-input" class="rounded-xl border border-black h-12 text-bold text-2xl pl-2 text-black dark:text-gray-200 bg-gray-700" type="text">
                <!-- Search results -->
                <div id="search-results">
                  <ul id="results-list" class="flex flex-col justify-center max-h-2xl mt-2 overflow-scroll"></ul>
                <!--Footer-->
                <!-- <div class="flex justify-end pt-2">
                  <button class="px-4 bg-transparent p-3 rounded-lg text-indigo-500 hover:bg-gray-100 hover:text-indigo-400 mr-2">Action</button>
                  <button class="modal-close px-4 bg-indigo-500 p-3 rounded-lg text-white hover:bg-indigo-400">Close</button>
                </div> -->

              </div>
            </div>
          </div>
        </div>
        

        <!---------------------------- Sidebar Menu ---------------------------->
        
          <div id="sidebar" class="nav-links -translate-x-full flex flex-col pt-6 p-2 text-2xl text-black dark:text-gray-200 bg-gray-200 dark:bg-gray-900 transform top-0 left-0 w-64 bg-white fixed h-full overflow-auto ease-in-out transition-all duration-300 z-30 shadow-2xl">
            
              
                
                  <a href="&#x2F;" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Home</a>
                
                  <a href="&#x2F;categories" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Categories</a>
                
                  <a href="&#x2F;tags" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Tags</a>
                
                  <a href="&#x2F;blog" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Blog</a>
                
              
            
          </div>
        

        
          <!-- Language change button -->
          <div class="flex p-2 ml-4 relative">
            <button id="switch-lang" type="button" class="bg-gray-200 text-gray-800 hover:text-gray-900 dark:bg-gray-800 dark:text-gray-400 dark:hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white">
              <svg class="w-6 h-6 bg-gray-200 text-gray-800 hover:text-gray-900 dark:bg-gray-800 dark:text-gray-400 dark:hover:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path>
              </svg>
            </button>
            <div id="switch-lang-panel" class="hidden absolute top-12 -left-1/2 z-10 p-4 rounded-lg divide-y bg-gray-300 dark:bg-gray-800 text-gray-800 dark:text-gray-400 flex flex-col w-28 ">
              <span class="sr-only">Switch Lang</span>
              
                
                  
                    <a class="flex justify-center py-2 hover:text-gray-800 dark:hover:text-white" href="&#x2F;">English</a>
                  
                
              
            </div>
          </div>
        
        <!-- Theme switch button -->
        <div class="flex p-2">
          <button id="switch-theme" type="button" class="bg-gray-200 text-gray-800 hover:text-gray-900 dark:bg-gray-800 dark:text-gray-400 dark:hover:text-white p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white">
            <span class="sr-only">Switch Theme</span>
            <!-- Heroicon name: outline/light -->
            <svg id="light" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
            <!-- Heroicon name: outline/dark -->
            <svg id="dark" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
            </svg>
          </button>

          <!-- Profile dropdown -->
          <!-- <div class="ml-3 relative">
            <div>
              <button type="button" class="bg-gray-800 flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                <span class="sr-only">Open user menu</span>
                <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
              </button>
            </div> -->

            <!--
              Dropdown menu, show/hide based on menu state.

              Entering: "transition ease-out duration-100"
                From: "transform opacity-0 scale-95"
                To: "transform opacity-100 scale-100"
              Leaving: "transition ease-in duration-75"
                From: "transform opacity-100 scale-100"
                To: "transform opacity-0 scale-95"
            -->
            <!-- Active: "bg-gray-100", Not Active: "" -->
            <!-- <div class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1">
              <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="user-menu-item-0">Your Profile</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="user-menu-item-1">Settings</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="user-menu-item-2">Sign out</a>
            </div> -->
          </div>
        </div>
      </div>
    </div>

    <!----------------------------- Mobile menu ----------------------------->
    <div id="mobile-menu" class="sm:hidden fixed z-10 overflow-hidden">
      <div class="nav-links flex flex-col space-y-4 items-center w-screen dark:bg-gray-800 transition-all ease-out duration-500 h-0">
        <!-- Current: "bg-gray-900 text-white", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
        
          
            
              <a href="&#x2F;" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Home</a>
            
              <a href="&#x2F;categories" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Categories</a>
            
              <a href="&#x2F;tags" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Tags</a>
            
              <a href="&#x2F;blog" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Blog</a>
            
          
        

        
            
              
                
                  <a href="&#x2F;" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Home</a>
                
                  <a href="&#x2F;categories" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Categories</a>
                
                  <a href="&#x2F;tags" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Tags</a>
                
                  <a href="&#x2F;blog" class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Blog</a>
                
              
            
        
      </div>
    </div>
  </nav>
  <!----------------------------------------------------------->
  <!------------------------- CONTENT ------------------------->
  <!----------------------------------------------------------->
  <main class="max-w-7xl mx-auto text-black dark:text-gray-200 w-full mb-auto">
    
<div class="flex">
   <h1 class="text-2xl text-bold my-6 mx-auto">
      Rust OS - Part 1
    </h1>
</div>
<div class="flex gap-x-8">
  <div class="flex flex-col sm:w-3/4 w-full border border-2 border-gray-200 dark:border-black rounded-xl p-5 shadow-2xl bg-gray-200 dark:bg-gray-800">

    <div class="flex flex-col py-2 justify-center">
     <!-- <h2 class="text-2xl text-bold"><a href='https:&#x2F;&#x2F;applepiesnx.github.io&#x2F;blog&#x2F;os-part-1&#x2F;'>Rust OS - Part 1</a></h2> -->
      <p class="text-bold"></p>
    </div>

    <!-- Read time and word count -->
    <div class="flex flex-wrap py-2">
      <div class="flex items-center w-1/3">
        <div class="flex flex-col sm:flex-row sm:space-x-3 text-gray-900 dark:text-gray-400">
          <span class="flex">
            <!-- Icon clock -->
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span class="ml-1">8 min</span>
          </span>
          <span class="flex">
            <!-- Icon pencil -->
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
            </svg>
            <span class="ml-1">1425 words</span>
          </span>
        </div>
      </div>
      <!-- Author and publish date -->
      <div class="flex w-2/3 sm:space-x-3 text-gray-900 dark:text-gray-400 justify-end">
         <span class="flex items-center">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
          <span class="ml-1"><time datetime="2022-02-18">Published on February 18, 2022</time></span>
        </span>
        <span class="flex items-center">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          
            <span class="ml-1">Praveen N</span>
            <img class="rounded-full h-9 w-9 ml-1" src="https:&#x2F;&#x2F;via.placeholder.com&#x2F;200" alt="Placeholder text describing the default author&#x27;s avatar.">
          
        </span>
      </div>
    </div>

    <!-- Categories and Tags -->
    <div class="flex flex-wrap py-2">
      <div class="w-2/3">
        
          <p>
            Categories:
            
            <a class="text-gray-900 dark:text-gray-400 flex py-1 items-center" href="https://applepiesnx.github.io/categories/os/">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
              </svg>
              <span class="pl-1">OS</span>
            </a>
            
          </p>
        
      </div>
      <div class="w-1/3">
        
        <p>
          Tags:
          
          <a class="text-gray-900 dark:text-gray-400 flex py-1 items-center" href="https://applepiesnx.github.io/tags/rust/">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
            </svg>
            <span class="pl-1">Rust</span>
          </a>
          
          <a class="text-gray-900 dark:text-gray-400 flex py-1 items-center" href="https://applepiesnx.github.io/tags/os/">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
            </svg>
            <span class="pl-1">OS</span>
          </a>
          
          <a class="text-gray-900 dark:text-gray-400 flex py-1 items-center" href="https://applepiesnx.github.io/tags/uefi/">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
            </svg>
            <span class="pl-1">UEFI</span>
          </a>
          
        </p>
        
      </div>
    </div>

    <!-- Content -->
    <div id="page-content" class="text-bold mt-2">
      <p>Welcome to part 1 of this blog series that will focus on creating a operating system kernel purely in rust.
This project was started as a means to deepen my knowledge of both Rust and operating system internals.</p>
<h1 id="introduction">Introduction</h1>
<p>Before we begin creating our kernel we need to make a few design decisions like what architecture
we are targeting and how our kernel will be booted. The present guide will focus on creating a kernel
targeting the x86_64 architecture. <br />
As for booting there are many paths we can take such as using BIOS, UEFI or
making our kernel multiboot2 compliant so that we can use any multiboot2 bootloader. Theres an argument
to be made for each of them but to keep things short we will be using a systems UEFI firmware to boot
our kernel. Therefore, the first step in creating our kernel will be to a write a UEFI bootloader in Rust.</p>
<h1 id="uefi-bootloader">UEFI Bootloader</h1>
<p>The first step would be to simply use cargo to create a new rust project.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>cargo new bootloader-rust
</span></code></pre>
<h2 id="building-the-bootloader">Building the Bootloader</h2>
<p>In order to compile this project so that it can be executed by the  UEFI firmware, we need to tell cargo that we are building this project for a x86_64 uefi system that has no underlying operating system. By default cargo will compile the project to be run on the operating system and architecture that it is being built on. We can overwrite this behaviour by passing the <code>--target=TARGET</code> flag to cargo to specify which target we want to build for. Fortunately for us Rust has an inbuilt target that we can use to build our project to be run directly on the UEFI firmware. Rust also supports the creation of our own custom targets, however we will get to that in a later part when we are creating our kernel. For now, lets use the in-built <code> x86_64-unknown-uefi</code> target to compile our project. We will also need to use the nightly compiler as we need to use a few unstable features. If the nightly compiler is not install it can be installed with the following command:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>rustup install nightly
</span></code></pre>
<p>So now with all that done, in order to build our bootloader we will run the following command:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>cargo +nightly build --target=x86_64-unknown-uefi
</span></code></pre>
<p>When we run this command we get the following error:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>error[E0463]: can&#39;t find crate for `std`
</span><span>  |
</span><span>  = note: the `x86_64-unknown-uefi` target may not be installed
</span><span>  = help: consider downloading the target with `rustup target add x86_64-unknown-uefi`
</span><span>  = help: consider building the standard library from source with `cargo build -Zbuild-std`
</span></code></pre>
<p>This is because the std crate depends on the underlying operating system to provide various features such as memory allocation. But we do not have an underlying operating system to provide these services therefore we need to tell the compiler that we do not intend to use the std crate. We do this by adding <code>#![no_std]</code> to the beginning of our <code>main.rs</code> file. </p>
<p>Now if we try to build it again we get a different error. Its a very similar error however, this time its complaining about the lack of the <code>core</code> and <code>compiler_builtins</code> crates. Unlike the <code>std</code> crate , we dont have an option of not using these crates as they are entire foundation the Rust language is built on. The reason these crates cant be found is becuase Rust does not provide precompiled binaries for the UEFI target. 
However, the nightly version of Rust does give us the option of compiling these crates on our own, and thats exactly what we'll be doing.</p>
<p>In order to compile these crates ourselves, we must first acquire the source for libstd. The following command can be used to download the source:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>rustup component add rust-src
</span></code></pre>
<p>once thats done we need to tell Cargo to use the unstable <code>build-std</code> feature to build the <code>core</code> and <code>compiler_builtins</code> crates. we do that by using the <code>-Z build-std</code> flag. Passing this flag will cause Cargo to implicitly build <code>core, std, alloc, and proc_macro</code> crates , however we will be specifying the exact crates we want to build by using the following syntax : <code>-Z build-std=&lt;crates to build&gt;</code>. With all that done our new build command looks like the following:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>cargo +nightly build -Z build-std=core,compiler_builtins --target=x86_64-unknown-uefi
</span></code></pre>
<p>Now we get two more new errors. The first is about the <code>println!</code> macro. This is to be expected as the  <code>println!</code> macro is provided by the <code>std</code> crate that we do not have access to. We can simply remove the macro from our code and the error should disappear. </p>
<p>The second error we have is complaining about the lack of a panic_handler function. Looking at the Rust documentation, it says that this funciton defines what the program will do when it panics. This fucntionality is normally provided by the <code>std</code> crate. This means we will have to define our own panic handler if we want to compile our program.</p>
<p>The panic handler function must have the following signature <code>fn(&amp;PanicInfo) -&gt; !</code>, and it needs to be marked with the <code>#[panic_handler]</code> attribute. Sounds easy enough so lets add it to our <code>main.rs</code> file. First we need to import the <code>PanicInfo</code> struct which is defined in the <code>core</code> crate. adding <code> use core::panic::PanicInfo;</code> to our file will take care of that. Next, we need to define a function with the above signature.</p>
<pre data-lang="Rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-Rust "><code class="language-Rust" data-lang="Rust"><span>#[</span><span style="color:#bf616a;">panic_handler</span><span>]
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">panic</span><span>(</span><span style="color:#bf616a;">_info</span><span>: &amp;PanicInfo) -&gt;!{
</span><span>	</span><span style="color:#b48ead;">loop</span><span>{}
</span><span>}
</span></code></pre>
<p>For the time being we will simply loop if our program panics. We will later expand the functionality of this as we become able to interact with the UEFI firmware.
With all of the above code added to our <code>main.rs</code> file, it  should look like the following:</p>
<pre data-lang="Rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-Rust "><code class="language-Rust" data-lang="Rust"><span>#![</span><span style="color:#bf616a;">no_std</span><span>]
</span><span style="color:#b48ead;">use </span><span>core::panic::PanicInfo;
</span><span>
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span>() {
</span><span>}
</span><span>
</span><span>#[</span><span style="color:#bf616a;">panic_handler</span><span>]
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">panic</span><span>(</span><span style="color:#bf616a;">_info</span><span>: &amp;PanicInfo) -&gt;!{
</span><span>	</span><span style="color:#b48ead;">loop</span><span>{}
</span><span>}
</span></code></pre>
<p>Now we have a new error. The compiler is complaining about the lack of the <code>start</code> <code>lang_item</code>. The start lang item is what defines the entry point of our program. When a program is executed, the first function that is run is not the main funciton but an entry point function that serves a few purposes, like setting up the stack for the program. The UEFI specification defines a function called <code>EFI_IMAGE_ENTRY_POINT</code> , this function is what the UEFI firmware expects to handover execution to. For UEFI application written in Rust the linker looks for a function named <code>efi_main</code> as the entry point. So lets add one. First we need to add <code>#![no_main]</code> to the top of our <code>main.rs</code> file to notify the compiler that our program will not have a standard main function. Next we will remove our existing main function and replace it with a function named efi_main. </p>
<p>However, simply doing so will not make our UEFI app compile. There are two issues here. Firstly, the name of our function gets mangled by the compiler to a less human readable name that contains information that makes compilation easier. This is a problem as the linker will be looking for a function with the name <code>efi_main</code>. The second problem is the calling convention of the function. The calling convention of a function defines many things including how parameters are passed to it , whether they are stored on the stack or passed through registers etc. Its very important that our <code>efi_main</code> function uses the calling convention the UEFI firmware expects us to.</p>
<p>The first issue can be solved by adding the  <code>#[no_mangle]</code> attribute to our <code>efi_main</code> function. This tells the compiler to not mangle its name.
For the second issue, Rust allows us to specify which calling convention we want to use with our functions through the following syntax: </p>
<pre data-lang="Rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-Rust "><code class="language-Rust" data-lang="Rust"><span style="color:#b48ead;">extern </span><span>&quot;</span><span style="color:#a3be8c;">[calling convention]</span><span>&quot; </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">my_function</span><span>()-&gt;!{}
</span></code></pre>
<p>Fortunately for us Rust supports the calling convention used by the UEFI firmware. In order to use it we need to first add <code>#![feature(abi_efiapi)]</code> to our <code>main.rs</code> file. Next we need to edit our definition of the <code>efi_main</code> function and add <code>pub extern &quot;efiapi&quot; fn efi_main</code> to it. With all these changes made our main.rs file should now look like the following:</p>
<pre data-lang="Rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-Rust "><code class="language-Rust" data-lang="Rust"><span>#![</span><span style="color:#bf616a;">no_std</span><span>]
</span><span>#![</span><span style="color:#bf616a;">no_main</span><span>]
</span><span>#![</span><span style="color:#bf616a;">feature</span><span>(abi_efiapi)]
</span><span style="color:#b48ead;">use </span><span>core::panic::PanicInfo;
</span><span>
</span><span>#[</span><span style="color:#bf616a;">no_mangle</span><span>]
</span><span style="color:#b48ead;">pub extern </span><span>&quot;</span><span style="color:#a3be8c;">efiapi</span><span>&quot; </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">efi_main</span><span>() {	
</span><span>}
</span><span>
</span><span>#[</span><span style="color:#bf616a;">panic_handler</span><span>]
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">panic</span><span>(</span><span style="color:#bf616a;">_info</span><span>: &amp;PanicInfo) -&gt;!{
</span><span>	</span><span style="color:#b48ead;">loop</span><span>{}
</span><span>}
</span></code></pre>
<p>And Finally attempting to compile it results in no errors! ðŸ˜ƒ</p>
<p>That all for part one. We have managed to create a basic UEFI app that we can build upon and turn into our bootloader. In the next part I will use the UEFI firmware's built in functions to print to the screen. </p>

    </div>



  </div>


    <!-- Table of content -->
    


</div>

  </main>

  <!----------------------------------------------------------->
  <!------------------------- PAGINATION ---------------------->
  <!----------------------------------------------------------->
  



  <!---------------------------------------------------------->
  <!------------------------- FOOTER ------------------------->
  <!---------------------------------------------------------->
  <footer class="max-w-7xl mx-auto relative pt-1 px-2 border-b-2 border-gray-300 dark:border-gray-200 w-full">
    <!-- <div class="container mx-auto px-6">
      <div class="sm:flex sm:mt-8">
        <div class="mt-8 sm:mt-0 sm:w-full sm:px-8 flex flex-col md:flex-row justify-between">
          <div class="flex flex-col">
            <span class="font-bold text-gray-700 uppercase mb-2">Footer header 1</span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
          </div>
          <div class="flex flex-col">
            <span class="font-bold text-gray-700 uppercase mt-4 md:mt-0 mb-2">Footer header 2</span>
            <span class="my-2"><a href="#" class="text-blue-700 text-md hover:text-blue-500">link 1</a></span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
            <span class="my-2"><a href="#" class="text-blue-700 text-md hover:text-blue-500">link 1</a></span>
          </div>
          <div class="flex flex-col">
            <span class="font-bold text-gray-700 uppercase mt-4 md:mt-0 mb-2">Footer header 3</span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
            <span class="my-2"><a href="#" class="text-blue-700  text-md hover:text-blue-500">link 1</a></span>
          </div>
        </div>
      </div>
    </div> -->
    <div class="mt-16 border-t-2 border-gray-300 flex flex-col items-center">
      <div class="sm:w-2/3 text-center py-6">
        <p class="text-sm text-black dark:text-white font-bold mb-2">
          Â© 2022 blow theme made with <a href="https://tailwindcss.com/" target="_blank">tailwindcss</a> for <a href="https://www.getzola.org/" target="_blank">Zola</a>
        </p>
      </div>
    </div>
  </footer>

  <!------------------------- SCRIPTS ------------------------->
  <script defer src="/js/main.js"></script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script>
    <script src="/search_index.en.js"></script>
    <script defer src="/js/search.js"></script>
  
  
    <script defer src="/js/lang.js"></script>
  
  
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=myclientid"
     crossorigin="anonymous"></script>
  
  
  <script defer src="/js/page.js"></script>

  </body>
</html>
